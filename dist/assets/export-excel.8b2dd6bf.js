var e=(e,a,l)=>new Promise(((t,n)=>{var o=e=>{try{s(l.next(e))}catch(a){n(a)}},i=e=>{try{s(l.throw(e))}catch(a){n(a)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,i);s((l=l.apply(e,a)).next())}));import{_ as a}from"./index.0aa33123.js";import{d as l,j as t,A as n,a7 as o,r as i,a8 as s,o as d,f as r,w as u,i as c,a as p,c as m,s as g,F as f,C as h,E as y,v as x,_ as v}from"./vendor.71a11aaa.js";import{t as b}from"./demo.ae0f3a5c.js";import{L as w}from"./index.f3301aa0.js";const{ElMessage:_}=v,T=l({name:"ExportExcel",components:{YuLayout:w},setup(){const l=t(""),i=t("xlsx"),s=t(["xlsx","csv","txt"]),d=t(!1),r=t(!1),u=t([]);function c(e,a){return a.map((a=>e.map((e=>"timestamp"===e?function(e,a){if(0===arguments.length||!e)return null;const l=a||"{y}-{m}-{d} {h}:{i}:{s}";let t;"object"==typeof e?t=e:("string"==typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"==typeof e&&10===e.toString().length&&(e*=1e3),t=new Date(e));const n={y:t.getFullYear(),m:t.getMonth()+1,d:t.getDate(),h:t.getHours(),i:t.getMinutes(),s:t.getSeconds(),a:t.getDay()};return l.replace(/{([ymdhisa])+}/g,((e,a)=>{const l=n[a];return"a"===a?["日","一","二","三","四","五","六"][l]:l.toString().padStart(2,"0")}))}(a[e]):a[e]))))}n((()=>e(this,null,(function*(){yield function(){return e(this,null,(function*(){r.value=!0;try{const{data:e}=yield b({});u.value=e}catch(e){u.value=[],_.error("获取列表出错")}finally{r.value=!1}}))}()})))),o((()=>{}));const p=t([{id:10001,name:"Test1",role:"Develop",sex:"Man",address:"Shenzhen"},{id:10002,name:"Test2",role:"Test",sex:"Man",address:"Guangzhou"},{id:10003,name:"Test3",role:"PM",sex:"Man",address:"Shanghai"}]);return{filename:l,fileType:i,options:s,downloadLoading:d,list:u,listLoading:r,handleDownload:function(){d.value=!0,a((()=>import("./Export2Excel.0de7c14b.js")),["./assets/Export2Excel.0de7c14b.js","./assets/FileSaver.min.7135435f.js","./assets/vendor.71a11aaa.js","./assets/___vite-browser-external_commonjs-proxy.eb24b2a5.js"]).then((e=>{const a=c(["id","title","author","pageviews","display_time"],u.value);e.export_json_to_excel({header:["Id","Title","Author","Readings","Date"],data:a,filename:l.value,bookType:i.value}),d.value=!1}))},tableData:p}}}),D={class:"app-container"},E={style:{display:"inline-block"}},j=c("label",{class:"radio-label",style:{"padding-left":"0"}},"文件名: ",-1),L={style:{display:"inline-block"}},M=c("label",{class:"radio-label"},"导出类型: ",-1),V=y(" 导出 "),k=c("i",{class:"el-icon-time"},null,-1);T.render=function(e,a,l,t,n,o){const v=i("el-input"),b=i("el-option"),w=i("el-select"),_=i("el-button"),T=i("el-table-column"),S=i("el-tag"),A=i("el-table"),I=i("yu-layout"),P=s("loading");return d(),r(I,{title:"表格",subtitle:"表格的简单使用"},{body:u((()=>[c("div",D,[c("div",null,[c("div",E,[j,p(v,{modelValue:e.filename,"onUpdate:modelValue":a[0]||(a[0]=a=>e.filename=a),placeholder:"请输入导出的文件名",style:{width:"345px"},"prefix-icon":"el-icon-document"},null,8,["modelValue"])]),c("div",L,[M,p(w,{modelValue:e.fileType,"onUpdate:modelValue":a[1]||(a[1]=a=>e.fileType=a),style:{width:"120px"}},{default:u((()=>[(d(!0),m(f,null,g(e.options,(e=>(d(),r(b,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),p(_,{loading:e.downloadLoading,style:{margin:"0 0 20px 20px"},type:"primary",icon:"el-icon-document",onClick:e.handleDownload},{default:u((()=>[V])),_:1},8,["loading","onClick"]),h(p(A,{data:e.list,"element-loading-text":"Loading...",border:"",fit:"","highlight-current-row":""},{default:u((()=>[p(T,{align:"center",label:"Id",width:"95"},{default:u((e=>[y(x(e.$index),1)])),_:1}),p(T,{label:"Title"},{default:u((e=>[y(x(e.row.title),1)])),_:1}),p(T,{label:"Author",width:"110",align:"center"},{default:u((e=>[p(S,null,{default:u((()=>[y(x(e.row.author),1)])),_:2},1024)])),_:1}),p(T,{label:"Readings",width:"115",align:"center"},{default:u((e=>[y(x(e.row.pageviews),1)])),_:1}),p(T,{align:"center",label:"Date",width:"220"},{default:u((e=>[k,c("span",null,x(e.row.timestamp),1)])),_:1})])),_:1},8,["data"]),[[P,e.listLoading]])])])])),_:1})};export default T;
